Fig. 5. Control flow chart.